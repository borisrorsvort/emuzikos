(function(){var a;a={};a.loadMaps=function(){var c,d,b;b=[];for(c in a){d=a[c];b.push(c!=="loadMaps"?window["load_"+c]():void 0)}return b};window.Gmaps=a;this.Gmaps4Rails=(function(){function b(){this.map=null;this.visibleInfoWindow=null;this.userLocation=null;this.geolocationFailure=function(){return false};this.callback=function(){return false};this.customClusterer=function(){return false};this.infobox=function(){return false};this.default_map_options={id:"map",draggable:true,detect_location:false,center_on_user:false,center_latitude:0,center_longitude:0,zoom:7,maxZoom:null,minZoom:null,auto_adjust:true,auto_zoom:true,bounds:[],raw:{}};this.default_markers_conf={title:"",picture:"",width:22,length:32,draggable:false,do_clustering:true,randomize:false,max_random_distance:100,list_container:null,offset:0,raw:{}};this.markers=[];this.boundsObject=null;this.polygons=[];this.polylines=[];this.circles=[];this.markerClusterer=null;this.markerImages=[]}b.prototype.initialize=function(){this.map=this.createMap();if(this.map_options.detect_location===true||this.map_options.center_on_user===true){this.findUserLocation(this)}return this.resetSidebarContent()};b.prototype.findUserLocation=function(c){var e,d;if(navigator.geolocation){d=function(f){c.userLocation=c.createLatLng(f.coords.latitude,f.coords.longitude);if(c.map_options.center_on_user===true){return c.centerMapOnUser()}};e=function(){return c.geolocationFailure(true)};return navigator.geolocation.getCurrentPosition(d,e)}else{return c.geolocationFailure(false)}};b.prototype.create_direction=function(){var c,e,d;c=new google.maps.DirectionsRenderer();e=new google.maps.DirectionsService();c.setMap(this.map);if(this.direction_conf.display_panel){c.setPanel(document.getElementById(this.direction_conf.panel_id))}c.setOptions({suppressMarkers:false,suppressInfoWindows:false,suppressPolylines:false});d={origin:this.direction_conf.origin,destination:this.direction_conf.destination,waypoints:this.direction_conf.waypoints,optimizeWaypoints:this.direction_conf.optimizeWaypoints,unitSystem:google.maps.DirectionsUnitSystem[this.direction_conf.unitSystem],avoidHighways:this.direction_conf.avoidHighways,avoidTolls:this.direction_conf.avoidTolls,region:this.direction_conf.region,travelMode:google.maps.DirectionsTravelMode[this.direction_conf.travelMode],language:"en"};return e.route(d,function(g,f){if(f===google.maps.DirectionsStatus.OK){return c.setDirections(g)}})};b.prototype.create_circles=function(){var g,f,d,e,c;e=this.circles;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];c.push(this.create_circle(g))}return c};b.prototype.create_circle=function(c){var d;if(c===this.circles[0]){if(c.strokeColor!=null){this.circles_conf.strokeColor=c.strokeColor}if(c.strokeOpacity!=null){this.circles_conf.strokeOpacity=c.strokeOpacity}if(c.strokeWeight!=null){this.circles_conf.strokeWeight=c.strokeWeight}if(c.fillColor!=null){this.circles_conf.fillColor=c.fillColor}if(c.fillOpacity!=null){this.circles_conf.fillOpacity=c.fillOpacity}}if((c.lat!=null)&&(c.lng!=null)){d=new google.maps.Circle({center:this.createLatLng(c.lat,c.lng),strokeColor:c.strokeColor||this.circles_conf.strokeColor,strokeOpacity:c.strokeOpacity||this.circles_conf.strokeOpacity,strokeWeight:c.strokeWeight||this.circles_conf.strokeWeight,fillOpacity:c.fillOpacity||this.circles_conf.fillOpacity,fillColor:c.fillColor||this.circles_conf.fillColor,clickable:c.clickable||this.circles_conf.clickable,zIndex:c.zIndex||this.circles_conf.zIndex,radius:c.radius});c.serviceObject=d;return d.setMap(this.map)}};b.prototype.clear_circles=function(){var g,f,d,e,c;e=this.circles;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];c.push(this.clear_circle(g))}return c};b.prototype.clear_circle=function(c){return c.serviceObject.setMap(null)};b.prototype.hide_circles=function(){var g,f,d,e,c;e=this.circles;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];c.push(this.hide_circle(g))}return c};b.prototype.hide_circle=function(c){return c.serviceObject.setMap(null)};b.prototype.show_circles=function(){var g,f,d,e,c;e=this.circles;c=[];for(f=0,d=e.length;f<d;f++){g=e[f];c.push(this.show_circle(this.circle))}return c};b.prototype.show_circle=function(c){return c.serviceObject.setMap(this.map)};b.prototype.create_polygons=function(){var e,g,d,f,c;f=this.polygons;c=[];for(g=0,d=f.length;g<d;g++){e=f[g];c.push(this.create_polygon(e))}return c};b.prototype.create_polygon=function(m){var c,n,d,e,o,h,p,k,g,f,l;h=[];for(f=0,l=m.length;f<l;f++){o=m[f];d=this.createLatLng(o.lat,o.lng);h.push(d);if(o===m[0]){p=this.polygons[i][j].strokeColor||this.polygons_conf.strokeColor;k=this.polygons[i][j].strokeOpacity||this.polygons_conf.strokeOpacity;g=this.polygons[i][j].strokeWeight||this.polygons_conf.strokeWeight;c=this.polygons[i][j].fillColor||this.polygons_conf.fillColor;n=this.polygons[i][j].fillOpacity||this.polygons_conf.fillOpacity}}e=new google.maps.Polygon({paths:h,strokeColor:p,strokeOpacity:k,strokeWeight:g,fillColor:c,fillOpacity:n,clickable:false});m.serviceObject=e;return e.setMap(this.map)};b.prototype.create_polylines=function(){var e,g,d,f,c;f=this.polylines;c=[];for(g=0,d=f.length;g<d;g++){e=f[g];c.push(this.create_polyline(e))}return c};b.prototype.create_polyline=function(q){var h,m,d,f,r,l,s,o,n,g,e,p,c,k;l=[];for(g=0,p=q.length;g<p;g++){m=q[g];if(m.coded_array!=null){h=new google.maps.geometry.encoding.decodePath(m.coded_array);k=h.length;for(e=0,c=k.length;e<c;e++){r=k[e];l.push(r);l.push(r)}}else{if(m===q[0]){s=m.strokeColor||this.polylines_conf.strokeColor;o=m.strokeOpacity||this.polylines_conf.strokeOpacity;n=m.strokeWeight||this.polylines_conf.strokeWeight}if((m.lat!=null)&&(m.lng!=null)){d=this.createLatLng(m.lat,m.lng);l.push(d)}}}f=new google.maps.Polyline({path:l,strokeColor:s,strokeOpacity:o,strokeWeight:n,clickable:false});q.serviceObject=f;return f.setMap(this.map)};b.prototype.create_markers=function(){this.createServiceMarkersFromMarkers();return this.clusterize()};b.prototype.createServiceMarkersFromMarkers=function(){var f,g,k,e,d,c,h;h=this.markers;for(e=0,c=h.length;e<c;e++){d=h[e];f=this.markers[e].lat;k=this.markers[e].lng;if(this.markers_conf.randomize){g=this.randomize(f,k);f=g[0];k=g[1]}this.markers[e].serviceObject=this.createMarker({marker_picture:this.markers[e].picture?this.markers[e].picture:this.markers_conf.picture,marker_width:this.markers[e].width?this.markers[e].width:this.markers_conf.width,marker_height:this.markers[e].height?this.markers[e].height:this.markers_conf.length,marker_title:this.markers[e].title?this.markers[e].title:null,marker_anchor:this.markers[e].marker_anchor?this.markers[e].marker_anchor:null,shadow_anchor:this.markers[e].shadow_anchor?this.markers[e].shadow_anchor:null,shadow_picture:this.markers[e].shadow_picture?this.markers[e].shadow_picture:null,shadow_width:this.markers[e].shadow_width?this.markers[e].shadow_width:null,shadow_height:this.markers[e].shadow_height?this.markers[e].shadow_height:null,marker_draggable:this.markers[e].draggable?this.markers[e].draggable:this.markers_conf.draggable,rich_marker:this.markers[e].rich_marker?this.markers[e].rich_marker:null,Lat:f,Lng:k,index:e});this.createInfoWindow(this.markers[e]);this.createSidebar(this.markers[e])}return this.markers_conf.offset=this.markers.length};b.prototype.createImageAnchorPosition=function(c){if(c===null){return null}else{return this.createPoint(c[0],c[1])}};b.prototype.replaceMarkers=function(c){this.clearMarkers();this.markers=new Array;this.boundsObject=this.createLatLngBounds();this.resetSidebarContent();this.markers_conf.offset=0;return this.addMarkers(c)};b.prototype.addMarkers=function(c){this.markers=this.markers.concat(c);this.create_markers();return this.adjustMapToBounds()};b.prototype.createSidebar=function(g){var h,d,f,c,e;if(this.markers_conf.list_container){e=document.getElementById(this.markers_conf.list_container);c=document.createElement("li");h=document.createElement("a");h.href="javascript:void(0);";f=g.sidebar!=null?g.sidebar:"Marker";h.innerHTML=f;d=this;h.onclick=this.sidebar_element_handler(d,g.serviceObject,"click");c.appendChild(h);return e.appendChild(c)}};b.prototype.sidebar_element_handler=function(d,c,e){return function(){d.map.panTo(c.position);return google.maps.event.trigger(c,e)}};b.prototype.resetSidebarContent=function(){var c;if(this.markers_conf.list_container!==null){c=document.getElementById(this.markers_conf.list_container);return c.innerHTML=""}};b.prototype.adjustMapToBounds=function(){var d,n,q,t,p,s,r,u,l,h,f,e,y,A,z,x,w,v,c,B,o,m,k,g;if(this.map_options.auto_adjust||this.map_options.bounds!==null){this.boundsObject=this.createLatLngBounds()}if(this.map_options.auto_adjust){this.extendBoundsWithMarkers();o=this.polylines;for(l=0,y=o.length;l<y;l++){r=o[l];u=r.serviceObject.latLngs.getArray()[0].getArray();for(h=0,A=r.length;h<A;h++){t=r[h];this.boundsObject.extend(t)}}m=this.polygons;for(f=0,z=m.length;f<z;f++){p=m[f];s=p.serviceObject.latLngs.getArray()[0].getArray();for(e=0,x=p.length;e<x;e++){t=p[e];this.boundsObject.extend(t)}}k=this.circles;for(c=0,w=k.length;c<w;c++){n=k[c];this.boundsObject.extend(n.serviceObject.getBounds().getNorthEast());this.boundsObject.extend(n.serviceObject.getBounds().getSouthWest())}}g=this.map_options.bounds;for(B=0,v=g.length;B<v;B++){d=g[B];d=this.createLatLng(d.lat,d.lng);this.boundsObject.extend(d)}if(this.map_options.auto_adjust||this.map_options.bounds.length>0){if(!this.map_options.auto_zoom){q=this.boundsObject.getCenter();this.map_options.center_latitude=q.lat();this.map_options.center_longitude=q.lng();return this.map.setCenter(q)}else{return this.fitBounds()}}};b.prototype.create_kml=function(){var c,g,e,f,d;f=this.kml;d=[];for(g=0,e=f.length;g<e;g++){c=f[g];d.push(c.serviceObject=this.createKmlLayer(c))}return d};b.prototype.exists=function(c){return c!==""&&typeof c!=="undefined"};b.prototype.randomize=function(g,f){var e,h,d,c;d=this.markers_conf.max_random_distance*this.random();c=this.markers_conf.max_random_distance*this.random();e=parseFloat(g)+(180/Math.PI)*(c/6378137);h=parseFloat(f)+(90/Math.PI)*(d/6378137)/Math.cos(g);return[e,h]};b.prototype.mergeObjectWithDefault=function(f,d){var g,c,e;g={};for(c in f){e=f[c];g[c]=e}for(c in d){e=d[c];if(g[c]==null){g[c]=e}}return g};b.prototype.mergeWithDefault=function(e){var d,c;d=this["default_"+e];c=this[e];this[e]=this.mergeObjectWithDefault(c,d);return true};b.prototype.random=function(){return Math.random()*2-1};return b})()}).call(this);(function(){var a=Object.prototype.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e;f.__super__=d.prototype;return f};this.Gmaps4RailsGoogle=(function(){b(c,Gmaps4Rails);function c(){c.__super__.constructor.apply(this,arguments);this.map_options={disableDefaultUI:false,disableDoubleClickZoom:false,type:"ROADMAP"};this.markers_conf={clusterer_gridSize:50,clusterer_maxZoom:5,custom_cluster_pictures:null,custom_infowindow_class:null};this.mergeWithDefault("map_options");this.mergeWithDefault("markers_conf");this.kml_options={clickable:true,preserveViewport:false,suppressInfoWindows:false};this.polygons_conf={strokeColor:"#FFAA00",strokeOpacity:0.8,strokeWeight:2,fillColor:"#000000",fillOpacity:0.35};this.polylines_conf={strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2};this.circles_conf={fillColor:"#00AAFF",fillOpacity:0.35,strokeColor:"#FFAA00",strokeOpacity:0.8,strokeWeight:2,clickable:false,zIndex:null};this.direction_conf={panel_id:null,display_panel:false,origin:null,destination:null,waypoints:[],optimizeWaypoints:false,unitSystem:"METRIC",avoidHighways:false,avoidTolls:false,region:null,travelMode:"DRIVING"}}c.prototype.createPoint=function(e,d){return new google.maps.Point(e,d)};c.prototype.createLatLng=function(e,d){return new google.maps.LatLng(e,d)};c.prototype.createLatLngBounds=function(){return new google.maps.LatLngBounds()};c.prototype.createMap=function(){var d,e;d={maxZoom:this.map_options.maxZoom,minZoom:this.map_options.minZoom,zoom:this.map_options.zoom,center:this.createLatLng(this.map_options.center_latitude,this.map_options.center_longitude),mapTypeId:google.maps.MapTypeId[this.map_options.type],mapTypeControl:this.map_options.mapTypeControl,disableDefaultUI:this.map_options.disableDefaultUI,disableDoubleClickZoom:this.map_options.disableDoubleClickZoom,draggable:this.map_options.draggable};e=this.mergeObjectWithDefault(this.map_options.raw,d);return new google.maps.Map(document.getElementById(this.map_options.id),e)};c.prototype.createMarkerImage=function(g,h,d,e,f){return new google.maps.MarkerImage(g,h,d,e,f)};c.prototype.createSize=function(e,d){return new google.maps.Size(e,d)};c.prototype.createMarker=function(g){var d,l,k,f,m,h,e;f=this.createLatLng(g.Lat,g.Lng);if(g.marker_picture===""&&g.rich_marker===null){d={position:f,map:this.map,title:g.marker_title,draggable:g.marker_draggable};m=this.mergeObjectWithDefault(this.markers_conf.raw,d);return new google.maps.Marker(m)}if(g.rich_marker!==null){return new RichMarker({position:f,map:this.map,draggable:g.marker_draggable,content:g.rich_marker,flat:g.marker_anchor===null?false:g.marker_anchor[1],anchor:g.marker_anchor===null?0:g.marker_anchor[0]})}l=this.createImageAnchorPosition(g.marker_anchor);h=this.createImageAnchorPosition(g.shadow_anchor);k=this.createOrRetrieveImage(g.marker_picture,g.marker_width,g.marker_height,l);e=this.createOrRetrieveImage(g.shadow_picture,g.shadow_width,g.shadow_height,h);d={position:f,map:this.map,icon:k,title:g.marker_title,draggable:g.marker_draggable,shadow:e};m=this.mergeObjectWithDefault(this.markers_conf.raw,d);return new google.maps.Marker(m)};c.prototype.includeMarkerImage=function(d,h){var g,f,e;for(g=0,e=d.length;g<e;g++){f=d[g];if(f.url===h){return g}}return false};c.prototype.createOrRetrieveImage=function(h,e,g,k){var f,d;if(h===""||h===null){return null}d=this.includeMarkerImage(this.markerImages,h);switch(d){case false:f=this.createMarkerImage(h,this.createSize(e,g),null,k,null);this.markerImages.push(f);return f;break;default:if(typeof d==="number"){return this.markerImages[d]}return false}};c.prototype.clearMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.clearMarker(f))}return d};c.prototype.showMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.showMarker(f))}return d};c.prototype.hideMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.hideMarker(f))}return d};c.prototype.clearMarker=function(d){return d.serviceObject.setMap(null)};c.prototype.showMarker=function(d){return d.serviceObject.setVisible(true)};c.prototype.hideMarker=function(d){return d.serviceObject.setVisible(false)};c.prototype.extendBoundsWithMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.boundsObject.extend(f.serviceObject.position))}return d};c.prototype.createClusterer=function(d){return new MarkerClusterer(this.map,d,{maxZoom:this.markers_conf.clusterer_maxZoom,gridSize:this.markers_conf.clusterer_gridSize,styles:this.customClusterer()})};c.prototype.clearClusterer=function(){return this.markerClusterer.clearMarkers()};c.prototype.clusterize=function(){var e,f,h,d,g;if(this.markers_conf.do_clustering===true){if(this.markerClusterer!==null){this.clearClusterer()}f=new Array;g=this.markers;for(h=0,d=g.length;h<d;h++){e=g[h];f.push(e.serviceObject)}return this.markerClusterer=this.createClusterer(f)}};c.prototype.createInfoWindow=function(f){var e,d,g;if(this.markers_conf.custom_infowindow_class===null&&(f.description!=null)){g=new google.maps.InfoWindow({content:f.description});d=this;return google.maps.event.addListener(f.serviceObject,"click",this.openInfoWindow(d,g,f.serviceObject))}else{if(f.description!=null){e=document.createElement("div");e.setAttribute("class",this.markers_conf.custom_infowindow_class);e.innerHTML=f.description;g=new InfoBox(this.infobox(e));d=this;return google.maps.event.addListener(f.serviceObject,"click",this.openInfoWindow(d,g,f.serviceObject))}}};c.prototype.openInfoWindow=function(e,f,d){return function(){if(e.visibleInfoWindow!==null){e.visibleInfoWindow.close()}f.open(e.map,d);return e.visibleInfoWindow=f}};c.prototype.createKmlLayer=function(d){var e;e=d.options||{};e=this.mergeObjectWithDefault(e,this.kml_options);d=new google.maps.KmlLayer(d.url,e);d.setMap(this.map);return d};c.prototype.fitBounds=function(){return this.map.fitBounds(this.boundsObject)};c.prototype.centerMapOnUser=function(){return this.map.setCenter(this.userLocation)};return c})()}).call(this);(function(){var a=Object.prototype.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e;f.__super__=d.prototype;return f};this.Gmaps4RailsBing=(function(){b(c,Gmaps4Rails);function c(){c.__super__.constructor.apply(this,arguments);this.map_options={type:"road"};this.markers_conf={infobox:"description"};this.mergeWithDefault("map_options");this.mergeWithDefault("markers_conf")}c.prototype.getMapType=function(){switch(this.map_options.type){case"road":return Microsoft.Maps.MapTypeId.road;case"aerial":return Microsoft.Maps.MapTypeId.aerial;case"auto":return Microsoft.Maps.MapTypeId.auto;case"birdseye":return Microsoft.Maps.MapTypeId.birdseye;case"collinsBart":return Microsoft.Maps.MapTypeId.collinsBart;case"mercator":return Microsoft.Maps.MapTypeId.mercator;case"ordnanceSurvey":return Microsoft.Maps.MapTypeId.ordnanceSurvey;default:return Microsoft.Maps.MapTypeId.auto}};c.prototype.createPoint=function(e,d){return new Microsoft.Maps.Point(e,d)};c.prototype.createLatLng=function(e,d){return new Microsoft.Maps.Location(e,d)};c.prototype.createLatLngBounds=function(){};c.prototype.createMap=function(){return new Microsoft.Maps.Map(document.getElementById(this.map_options.id),{credentials:this.map_options.provider_key,mapTypeId:this.getMapType(),center:this.createLatLng(this.map_options.center_latitude,this.map_options.center_longitude),zoom:this.map_options.zoom})};c.prototype.createSize=function(e,d){return new google.maps.Size(e,d)};c.prototype.createMarker=function(f){var d,e;e=this.createLatLng(f.Lat,f.Lng);d;if(f.marker_picture===""){d=new Microsoft.Maps.Pushpin(this.createLatLng(f.Lat,f.Lng),{draggable:f.marker_draggable,anchor:this.createImageAnchorPosition(f.Lat,f.Lng),text:f.marker_title})}else{d=new Microsoft.Maps.Pushpin(this.createLatLng(f.Lat,f.Lng),{draggable:f.marker_draggable,anchor:this.createImageAnchorPosition(f.Lat,f.Lng),icon:f.marker_picture,height:f.marker_height,text:f.marker_title,width:f.marker_width})}this.addToMap(d);return d};c.prototype.clearMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.clearMarker(f))}return d};c.prototype.clearMarker=function(d){return this.removeFromMap(d.serviceObject)};c.prototype.showMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.showMarker(f))}return d};c.prototype.showMarker=function(d){return d.serviceObject.setOptions({visible:true})};c.prototype.hideMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.hideMarker(f))}return d};c.prototype.hideMarker=function(d){return d.serviceObject.setOptions({visible:false})};c.prototype.extendBoundsWithMarkers=function(){var f,e,h,d,g;f=[];g=this.markers;for(h=0,d=g.length;h<d;h++){e=g[h];f.push(e.serviceObject.getLocation())}return this.boundsObject=Microsoft.Maps.LocationRect.fromLocations(f)};c.prototype.createClusterer=function(d){};c.prototype.clearClusterer=function(){};c.prototype.clusterize=function(){};c.prototype.createInfoWindow=function(e){var d;if(e.description!=null){if(this.markers_conf.infobox==="description"){e.info_window=new Microsoft.Maps.Infobox(e.serviceObject.getLocation(),{description:e.description,visible:false,showCloseButton:true})}else{e.info_window=new Microsoft.Maps.Infobox(e.serviceObject.getLocation(),{htmlContent:e.description,visible:false})}d=this;Microsoft.Maps.Events.addHandler(e.serviceObject,"click",this.openInfoWindow(d,e.info_window));return this.addToMap(e.info_window)}};c.prototype.openInfoWindow=function(d,e){return function(){if(d.visibleInfoWindow){d.visibleInfoWindow.setOptions({visible:false})}e.setOptions({visible:true});return d.visibleInfoWindow=e}};c.prototype.fitBounds=function(){return this.map.setView({bounds:this.boundsObject})};c.prototype.addToMap=function(d){return this.map.entities.push(d)};c.prototype.removeFromMap=function(d){return this.map.entities.remove(d)};c.prototype.centerMapOnUser=function(){return this.map.setView({center:this.userLocation})};return c})()}).call(this);(function(){var a=Object.prototype.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e;f.__super__=d.prototype;return f};this.Gmaps4RailsOpenlayers=(function(){b(c,Gmaps4Rails);function c(){c.__super__.constructor.apply(this,arguments);this.map_options={};this.mergeWithDefault("map_options");this.markers_conf={};this.mergeWithDefault("markers_conf");this.openMarkers=null;this.markersLayer=null;this.markersControl=null}c.prototype.createPoint=function(e,d){};c.prototype.createLatLng=function(e,d){return new OpenLayers.LonLat(d,e).transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:900913"))};c.prototype.createAnchor=function(d){if(d===null){return null}return new OpenLayers.Pixel(d[0],d[1])};c.prototype.createSize=function(e,d){return new OpenLayers.Size(e,d)};c.prototype.createLatLngBounds=function(){return new OpenLayers.Bounds()};c.prototype.createMap=function(){var d;d=new OpenLayers.Map(this.map_options.id);d.addLayer(new OpenLayers.Layer.OSM());d.setCenter(this.createLatLng(this.map_options.center_latitude,this.map_options.center_longitude),this.map_options.zoom);return d};c.prototype.createMarker=function(e){var d,f;f=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style["default"]);f.fillOpacity=1;if(this.markersLayer===null){this.markersLayer=new OpenLayers.Layer.Vector("Markers",null);this.map.addLayer(this.markersLayer);this.markersLayer.events.register("featureselected",this.markersLayer,this.onFeatureSelect);this.markersLayer.events.register("featureunselected",this.markersLayer,this.onFeatureUnselect);this.markersControl=new OpenLayers.Control.SelectFeature(this.markersLayer);this.map.addControl(this.markersControl);this.markersControl.activate()}if(e.marker_picture===""){f.graphicHeight=30;f.externalGraphic="http://openlayers.org/dev/img/marker-blue.png"}else{f.graphicWidth=e.marker_width;f.graphicHeight=e.marker_height;f.externalGraphic=e.marker_picture;if(e.marker_anchor!==null){f.graphicXOffset=e.marker_anchor[0];f.graphicYOffset=e.marker_anchor[1]}if(e.shadow_picture!==""){f.backgroundGraphic=e.shadow_picture;f.backgroundWidth=e.shadow_width;f.backgroundHeight=e.shadow_height;if(e.shadow_anchor!==null){f.backgroundXOffset=e.shadow_anchor[0];f.backgroundYOffset=e.shadow_anchor[1]}}}f.graphicTitle=e.title;d=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(e.Lng,e.Lat),null,f);d.geometry.transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:900913"));this.markersLayer.addFeatures([d]);return d};c.prototype.clearMarkers=function(){this.clearMarkersLayerIfExists();this.markersLayer=null;return this.boundsObject=new OpenLayers.Bounds()};c.prototype.clearMarkersLayerIfExists=function(){if(this.markersLayer!==null&&this.map.getLayer(this.markersLayer.id)!==null){return this.map.removeLayer(this.markersLayer)}};c.prototype.extendBoundsWithMarkers=function(){var f,h,e,g,d;g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.boundsObject.extend(this.createLatLng(f.lat,f.lng)))}return d};c.prototype.createClusterer=function(f){var h,d,e,k,g;e={pointRadius:"${radius}",fillColor:"#ffcc66",fillOpacity:0.8,strokeColor:"#cc6633",strokeWidth:"${width}",strokeOpacity:0.8};d={context:{width:function(l){var m;return(m=l.cluster)!=null?m:{2:1}},radius:function(m){var l;l=2;if(m.cluster){l=Math.min(m.attributes.count,7)+2}return l}}};g=new OpenLayers.Style(e,d);k=new OpenLayers.Strategy.Cluster();h=new OpenLayers.Layer.Vector("Clusters",{strategies:[k],styleMap:new OpenLayers.StyleMap({"default":g,select:{fillColor:"#8aeeef",strokeColor:"#32a8a9"}})});this.clearMarkersLayerIfExists();this.map.addLayer(h);h.addFeatures(f);return h};c.prototype.clusterize=function(){var e,f,g,d;if(this.markers_conf.do_clustering===true){if(this.markerClusterer!==null){this.clearClusterer()}f=new Array;for(g=0,d=markers.length;g<d;g++){e=markers[g];f.push(e.serviceObject)}return this.markerClusterer=this.createClusterer(f)}};c.prototype.clearClusterer=function(){return this.map.removeLayer(this.markerClusterer)};c.prototype.createInfoWindow=function(d){if(d.description!=null){return d.serviceObject.infoWindow=d.description}};c.prototype.onPopupClose=function(d){return this.markersControl.unselect(this.feature)};c.prototype.onFeatureSelect=function(e){var f,d;f=e.feature;d=new OpenLayers.Popup.FramedCloud("featurePopup",f.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(300,200),f.infoWindow,null,true,this.onPopupClose);f.popup=d;d.feature=f;return this.map.addPopup(d)};c.prototype.onFeatureUnselect=function(d){var e;e=d.feature;if(e.popup){this.map.removePopup(e.popup);e.popup.destroy();return e.popup=null}};c.prototype.fitBounds=function(){return this.map.zoomToExtent(this.boundsObject,true)};c.prototype.centerMapOnUser=function(){return this.map.setCenter(this.userLocation)};return c})()}).call(this);(function(){var a=Object.prototype.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e;f.__super__=d.prototype;return f};this.Gmaps4RailsMapquest=(function(){b(c,Gmaps4Rails);function c(){c.__super__.constructor.apply(this,arguments);this.map_options={type:"map"};this.markers_conf={};this.mergeWithDefault("markers_conf");this.mergeWithDefault("map_options")}c.prototype.createPoint=function(e,d){return new MQA.Poi({lat:e,lng:d})};c.prototype.createLatLng=function(e,d){return{lat:e,lng:d}};c.prototype.createLatLngBounds=function(){};c.prototype.createMap=function(){var d;d=new MQA.TileMap(document.getElementById(this.map_options.id),this.map_options.zoom,{lat:this.map_options.center_latitude,lng:this.map_options.center_longitude},this.map_options.type);MQA.withModule("zoomcontrol3",(function(){return d.addControl(new MQA.LargeZoomControl3(),new MQA.MapCornerPlacement(MQA.MapCorner.TOP_LEFT))}));return d};c.prototype.createMarkerImage=function(g,h,d,e,f){};c.prototype.createMarker=function(e){var f,d;d=new MQA.Poi({lat:e.Lat,lng:e.Lng});if(e.marker_picture!==""){f=new MQA.Icon(e.marker_picture,e.marker_height,e.marker_width);d.setIcon(f);if(e.marker_anchor!==null){d.setBias({x:e.marker_anchor[0],y:e.marker_anchor[1]})}}if(e.shadow_picture!==""){f=new MQA.Icon(e.shadow_picture,e.shadow_height,e.shadow_width);d.setShadow(f);if(e.shadow_anchor!==null){d.setShadowOffset({x:e.shadow_anchor[0],y:e.shadow_anchor[1]})}}this.addToMap(d);return d};c.prototype.clearMarkers=function(){var f,g,e,d;d=[];for(g=0,e=markers.length;g<e;g++){f=markers[g];d.push(this.clearMarker(f))}return d};c.prototype.showMarkers=function(){var f,g,e,d;d=[];for(g=0,e=markers.length;g<e;g++){f=markers[g];d.push(this.showMarker(f))}return d};c.prototype.hideMarkers=function(){var f,g,e,d;d=[];for(g=0,e=markers.length;g<e;g++){f=markers[g];d.push(this.hideMarker(f))}return d};c.prototype.clearMarker=function(d){return this.removeFromMap(d.serviceObject)};c.prototype.showMarker=function(d){};c.prototype.hideMarker=function(d){};c.prototype.extendBoundsWithMarkers=function(){var f,h,e,g,d;if(this.markers.length>=2){this.boundsObject=new MQA.RectLL(this.markers[0].serviceObject.latLng,this.markers[1].serviceObject.latLng);g=this.markers;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.boundsObject.extend(f.serviceObject.latLng))}return d}};c.prototype.createClusterer=function(d){};c.prototype.clearClusterer=function(){};c.prototype.clusterize=function(){};c.prototype.createInfoWindow=function(d){return d.serviceObject.setInfoTitleHTML(d.description)};c.prototype.fitBounds=function(){if(this.markers.length>=2){this.map.zoomToRect(this.boundsObject)}if(this.markers.length===1){return this.map.setCenter(this.markers[0].serviceObject.latLng)}};c.prototype.centerMapOnUser=function(){return this.map.setCenter(this.userLocation)};c.prototype.addToMap=function(d){return this.map.addShape(d)};c.prototype.removeFromMap=function(d){return this.map.removeShape(d)};return c})()}).call(this);